# レシート一覧作成スクリプト

## 概要

指定したディレクトリ内のレシート画像ファイルから、支払い情報を抽出してCSVファイルに出力するスクリプトです。

## 機能

- 指定したディレクトリ内の画像ファイルを直接検索
- ファイル名から以下の情報を抽出：
  - 支払日（YYYY-MM-DD形式）
  - 金額（円）
  - 支払先
  - ファイル名
- CSVファイルに情報を出力
- 不明なファイル名の表示（オプション）

## 使用方法

```bash
python scripts/listup_receipts.py --year 2025 --input-dir /path/to/receipts
```

### 引数

- `--year`: 対象年（必須）
- `--input-dir`: レシートファイルが直接格納されているディレクトリのパス（必須）
- `--show-unknown`: 不明なファイル名を表示（オプション）

### 例

```bash
# 2025年のレシート情報を取得
python scripts/listup_receipts.py --year 2025 --input-dir ~/Desktop/toriR.Lab/5.確定申告/2025年領収書

# 不明なファイル名も表示
python scripts/listup_receipts.py --year 2025 --input-dir ~/Desktop/toriR.Lab/5.確定申告/2025年領収書 --show-unknown

# 出力をファイルにリダイレクト
python scripts/listup_receipts.py --year 2025 --input-dir ~/Desktop/toriR.Lab/5.確定申告/2025年領収書 > receipts_2025.csv
```

## ファイル名の形式

スクリプトは以下の形式のファイル名を解析します：

```
YYYY-MM-DD_金額円_支払先.拡張子
```

例：
```
2025-01-15_2500円_スーパーマーケット.jpg
2025-02-20_1800円_ガソリンスタンド.jpg
```

## 出力形式

CSVファイルには以下の列が含まれます：

- `date`: 支払日（YYYY-MM-DD形式）
- `amount`: 金額（円）
- `payee`: 支払先
- `filename`: ファイル名

## 不明なファイル名の表示

`--show-unknown`オプションを指定すると、以下のようなファイル名が不明として表示されます：

1. 日付の形式が不正な場合
2. 金額の形式が不正な場合
3. 支払先が空の場合
4. ファイル名の形式が異なる場合

不明なファイル名は標準エラー出力に表示され、CSVには含まれません。

## エラー処理

- ファイル名の形式が異なる場合は「不明」として処理
- 日付の形式が不正な場合も適切に処理
- ディレクトリが見つからない場合はエラーメッセージを表示

## 注意事項

- 画像ファイルの拡張子は`.jpg`、`.jpeg`、`.png`、`.pdf`に対応
- 大文字小文字を区別しない
- UTF-8エンコーディングで日本語に対応
- 指定したディレクトリ内のファイルのみを検索（サブディレクトリは探索しない）
